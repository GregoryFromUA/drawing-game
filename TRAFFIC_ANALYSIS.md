# –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã WebSocket —Ç—Ä–∞—Ñ–∏–∫–∞

## üî¥ –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞ #1: –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ–ª–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ sharedDrawing –ø—Ä–∏ –∫–∞–∂–¥–æ–º —à—Ç—Ä–∏—Ö–µ
**–õ–æ–∫–∞—Ü–∏—è:** `server.js:1687, 1714`

```javascript
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û
io.to(currentRoomCode).emit('drawing_stroke_added', {
  stroke: {...},
  sharedDrawing: room.sharedDrawing  // –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –í–°–ï —à—Ç—Ä–∏—Ö–∏!
});
```

**–í–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ:**
- 1 —à—Ç—Ä–∏—Ö = 95 –±–∞–π—Ç
- –ó–∞ 1 –º–∏–Ω—É—Ç—É –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ä–∏—Å–æ–≤–∞–Ω–∏—è: ~1200 —à—Ç—Ä–∏—Ö–æ–≤ = 111 KB
- –û—Ç–ø—Ä–∞–≤–∫–∞ 20 —Ä–∞–∑/—Å–µ–∫: 111 KB √ó 20 = **2.2 MB/—Å–µ–∫**
- –ó–∞ 2 —á–∞—Å–∞ √ó 5 –∏–≥—Ä–æ–∫–æ–≤: **~76 GB**

### –ü—Ä–æ–±–ª–µ–º–∞ #2: sharedDrawing –≤ getState()
**–õ–æ–∫–∞—Ü–∏—è:** `server.js:1196`

```javascript
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û
getState() {
  return {
    // ...
    sharedDrawing: this.sharedDrawing,  // –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –í–°–ï —à—Ç—Ä–∏—Ö–∏!
  };
}
```

**–í–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ:**
- `getState()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ö–ê–ñ–î–û–ú —Å–æ–±—ã—Ç–∏–∏:
  - player_joined
  - player_ready_changed
  - next_turn (–∫–∞–∂–¥—ã–µ 60 —Å–µ–∫)
  - round_ended
  - –∏ –¥—Ä.
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ ~100-500 KB –Ω–∞ —Å–æ–±—ã—Ç–∏–µ

### –ü—Ä–æ–±–ª–µ–º–∞ #3: –ö–ª–∏–µ–Ω—Ç –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
**–õ–æ–∫–∞—Ü–∏—è:** `src/App.jsx:291-292, 296-297`

```javascript
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û
newSocket.on('drawing_strokes_added', ({ strokes, sharedDrawing }) => {
    setSharedDrawing(sharedDrawing);  // –ó–∞–º–µ–Ω—è–µ—Ç –≤–µ—Å—å –º–∞—Å—Å–∏–≤
});
```

**–í–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ:**
- –ö–ª–∏–µ–Ω—Ç –Ω–µ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—É—é –æ—Ç—Ä–∏—Å–æ–≤–∫—É —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ
- –ü–æ–ª—É—á–∞–µ—Ç –≤–µ—Å—å –º–∞—Å—Å–∏–≤ –∫–∞–∂–¥—ã–π —Ä–∞–∑

---

## ‚úÖ –†–µ—à–µ–Ω–∏—è

### –†–µ—à–µ–Ω–∏–µ #1: –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ —à—Ç—Ä–∏—Ö–∏ (–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ)

**–°–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å:**
```javascript
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
io.to(currentRoomCode).emit('drawing_strokes_added', {
  strokes: strokes.map(stroke => ({
    ...stroke,
    playerId: currentPlayerId,
    color: room.playerColors.get(currentPlayerId)
  }))
  // –ù–ï –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º sharedDrawing!
});
```

**–ö–ª–∏–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –¥–æ–±–∞–≤–ª—è—Ç—å:**
```javascript
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
newSocket.on('drawing_strokes_added', ({ strokes }) => {
    setSharedDrawing(prev => [...prev, ...strokes]);  // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ
});
```

### –†–µ—à–µ–Ω–∏–µ #2: –£–±—Ä–∞—Ç—å sharedDrawing –∏–∑ getState()

```javascript
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
getState() {
  return {
    // ...
    // sharedDrawing –ù–ï –≤–∫–ª—é—á–∞–µ–º! –û–Ω —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ
  };
}
```

### –†–µ—à–µ–Ω–∏–µ #3: –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ø–æ–ª–Ω—ã–π –º–∞—Å—Å–∏–≤ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

–û—Ç–ø—Ä–∞–≤–ª—è—Ç—å `sharedDrawing` –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ç–æ–ª—å–∫–æ:
- –ü—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏/–ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∏–≥—Ä–æ–∫–∞
- –ü—Ä–∏ –Ω–∞—á–∞–ª–µ –Ω–æ–≤–æ–≥–æ —Ä–∞—É–Ω–¥–∞
- –ü–æ –∑–∞–ø—Ä–æ—Å—É –∫–ª–∏–µ–Ω—Ç–∞ (–µ—Å–ª–∏ —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è)

---

## üìä –û–∂–∏–¥–∞–µ–º–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ

**–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- ~76 GB –∑–∞ 2 —á–∞—Å–∞ (—Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–π –º–∞–∫—Å–∏–º—É–º)
- ~8.74 GB –∑–∞ 2 —á–∞—Å–∞ (—Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)

**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- –¢–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ —à—Ç—Ä–∏—Ö–∏: ~50 –±–∞–π—Ç √ó 20/—Å–µ–∫ = **1 KB/—Å–µ–∫**
- –ó–∞ 2 —á–∞—Å–∞ √ó 5 –∏–≥—Ä–æ–∫–æ–≤: **~36 MB** ‚úÖ
- **–°–Ω–∏–∂–µ–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–∞ –≤ ~240 —Ä–∞–∑!**

---

## üîç –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **Rate limiting** - —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (60 —Å–æ–æ–±—â–µ–Ω–∏–π/—Å–µ–∫)
2. **–ö–æ–º–ø—Ä–µ—Å—Å–∏—è WebSocket** - Socket.io –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∏–∑ –∫–æ—Ä–æ–±–∫–∏
3. **–î–µ–ª—å—Ç–∞-—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** - –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç—Ä–∞—Ñ–∏–∫–∞** - –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π

---

## üìù –ü–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

1. ‚úÖ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –∞–Ω–∞–ª–∏–∑
2. ‚è≥ –î–æ–±–∞–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ç—Ä–∞—Ñ–∏–∫–∞
3. ‚è≥ –ò—Å–ø—Ä–∞–≤–∏—Ç—å server.js (—É–±—Ä–∞—Ç—å sharedDrawing –∏–∑ broadcast)
4. ‚è≥ –ò—Å–ø—Ä–∞–≤–∏—Ç—å App.jsx (–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ)
5. ‚è≥ –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É –ø–æ–ª–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏
6. ‚è≥ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
7. ‚è≥ –î–µ–ø–ª–æ–π –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

---

–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞: 2025-11-10
